<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Realistic water visualization in 3D - 4.13</title>
    <link rel="stylesheet" href="https://js.arcgis.com/4.13/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.13/"></script>

    <script>
        require([
            "esri/Map",
            "esri/views/MapView",
            "esri/layers/FeatureLayer",
            "esri/layers/TileLayer",
            "esri/widgets/Slider"
        ], function (Map, MapView, FeatureLayer, TileLayer, Slider) {

            var map = new Map({
                // basemap: "streets"
            });

            const view = new MapView({
                container: "viewDiv",
                map: map
            });

            const streetsBasemap = new TileLayer({
                url: "https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"
            });

            const terrainMap = new TileLayer({
                url: "https://services.arcgisonline.com/arcgis/rest/services/World_Terrain_Base/MapServer"
            });

            const imageryBasemap = new TileLayer({
                url: "https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer"
            });

            const topoBasemap = new TileLayer({
                url: "https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer"
            });

            const shadeReliefBasemap = new TileLayer({
                url: "https://services.arcgisonline.com/arcgis/rest/services/World_Shaded_Relief/MapServer"
            })

            view.ui.add("menu", "top-right");

            const slider = new Slider({
                container: "waveSlider",
                min: 0,
                max: 100,
                labelsVisible: false,
                precision: 0,
                values: [0],
                draggableSegmentsEnabled: false,
            });

            // rendering the groups of ticks and 
            // giving them names according to their layers
            slider.tickConfigs = [{
                mode: "percent",
                values: [0, 25, 50, 75, 100],
                labelsVisible: true,
                tickCreatedFunction: function (initialValue, tickElement, labelElement) {
                    initialValue === 0 ?
                        labelElement['innerText'] = 'streets' :
                        initialValue === 25 ?
                        labelElement['innerText'] = 'terrain' :
                        initialValue === 50 ?
                        labelElement['innerText'] = 'imagery' :
                        initialValue === 75 ?
                        labelElement['innerText'] = 'topographic' :
                        initialValue === 100 ?
                        labelElement['innerText'] = 'shade' :
                        ''
                }
            }];

            // //Slider Logic
            // function changeOpacity(op) {
            //     var newOp = op / 100;
            //     imageryBasemap.opacity = (1.0 - newOp);
            //     topoBasemap.opacity = (newOp);
            // }


            //Slider Logic
            function changeOpacity(layer1, layer2, floorVal, ceilVal) {
                console.log({
                    floorVal,
                    ceilVal
                });
                // var newOp = op / 100;
                // imageryBasemap.opacity = (1.0 - newOp);
                // topoBasemap.opacity = (newOp);

                // const layer1Opacity = '';
                // const layer2Opacity = '';

                // layer1.opacity = '';
                // layer2.opacity = '';


            }

            function findFloorAndCeiling(value) {
                console.log(value)
                return (0 < value < 25) ?
                    changeOpacity(streetsBasemap, terrainMap, 0, 25) :
                    (25 < value < 50) ?
                    changeOpacity(terrainMap, imageryBasemap, 25, 50) :
                    (50 < value < 75) ?
                    changeOpacity(imageryBasemap, topoBasemap, 50, 75) :
                    (75 < value < 100) ?
                    changeOpacity(topoBasemap, shadeReliefBasemap, 75, 100) :
                    ''
            }

            slider.on("thumb-drag", function (event) {
                const value = parseInt(event.value);
                // console.log(value);
                findFloorAndCeiling(value);
            });


        });
    </script>
    <style>
        html,
        body,
        #viewDiv {
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
        }

        #menu {
            padding: 2em;
            width: 400px;
        }

        #waveSlider {
            height: 50px;
            margin-top: 2em;
        }

        .slider {
            width: 96%;
            text-align: center;
        }
    </style>
</head>

<body>
    <div id="viewDiv"></div>
    <div id="menu" class="esri-widget">
        <h4>Layer Opacity</h4>
        <div class="slider" id="waveSlider"></div>

    </div>
</body>

</html>